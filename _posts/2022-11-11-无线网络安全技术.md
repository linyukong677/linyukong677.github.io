---
layout: post
title: 计算机网络安全技术——无线网络安全技术
date: 2022-11-11 16:17 +0800
last_modified_at: 2022-11-12 08:11 +0800
tags: [Notes]
toc:  true
math: true
---

本文内容是2022年秋季学期清华大学计算机系本科课程《计算机网络安全技术》的笔记。（无线网络安全技术部分）
{: .message }

请在脑海里想象一个无线局域网的体系，比如一台无线路由器和几台无线接入wifi的主机。你会发现无线局域网是很不安全的一个体系，因为它的信道是公开的（无线电波），任何一个人发出的任何一条消息，对于其他所有人都是可见的。

在这种情况下，可想而知，无线局域网的安全性是一个很大的问题。

## 无线局域网的安全问题举例

无线窃听：无线信道是一个开放性信道，任何具有适当无线设备的人均可以通过窃听无线信道而获得上述信息

假冒攻击：攻击者通过窃听截获到一个合法用户的身份信息，就可以利用这个身份信息来假冒该合法用户的身份入网

信息篡改：截胡+篡改。攻击者将窃听到的信息进行修改（如删除或替代部分或全部信息）之后再将信息传给原本的接收者

重放攻击：重放攻击是攻击者复制有效的消息事后重新发送或重用这些消息以访问某种资源。比如A有一条访问数据库资源的消息被B截获，B将这条信息原样存下来，以后就可以用这条信息来访问数据库资源了。

重路由攻击：攻击者改变消息路由以便捕获有关信息

删除消息攻击：在消息到达目的地前将消息删除掉，使得接收者无法收到消息

错误路由攻击：将消息路由到错误的目的地

洪泛攻击：入侵者发送大量伪造的或无关消息从而使得AP忙于处理这些消息而耗尽信道资源和系统资源，进而无法对合法用户提供服务

## 无线局域网加密认证技术

首先熟悉一些无线局域网的基本概念：

- 无线接入点AP：无线网络的中心节点，无线路由器
- STA站点：接入无线网的终端
- SSID：每个AP配置的标志名，俗称wifi名

### 无加密认证

很简单，STA只要能够向AP发送正确的SSID，就可以接入无线网络。这种方式的安全性是最低的，因为任何人只要知道SSID就可以接入无线网络。这种认证又叫做开放系统认证。

### 在线等效加密认证WEP

WEP是一种在线等效加密认证方式，提供以下安全措施：

- 认证：除了最基础的开放系统认证，还有共享密钥认证
- 保密性：RC4流加密算法
- 完整性：CRC32校验和

#### 加密过程

![WEP加密.png](https://s2.loli.net/2022/11/11/UqNhjXZaGsODmWx.png)

1. 24位随机初始化向量IV，共享密钥（发送和接收方都知道）$$K_0$$，经过伪随机数产生器，生成一次性密钥$$K_E$$。
2. 明文P，计算CRC-32校验码ICV，拼接到P后面
3. 用$$K_E$$与P和ICV异或进行加密，得到密文Y
4. 密文Y与初始化向量IV打包发送

#### 解密过程

![WEP解密.png](https://s2.loli.net/2022/11/11/CMZcnH4goUIw36T.png)

从收到的消息中分离出IV，与共享密钥一起生成一次性密钥$$K_E$$（此时$$K_E$$应该和加密时用的一次性密钥相同）。用$$K_E$$解密密文，得到明文和ICV，进行CRC-32校验检查

### WEP安全性分析

1. 同一个SSID的无线局域网里面的所有终端共享一个密钥，容易泄露
2. ICV明文发送，不安全
3. IV只有24位，容易重复（发送很多条，IV就会重复出现）
4. CRC-32校验很简单，检查能力不足，无法做消息验证（或者说CRC-32校验码不是一个好的消息认证码）
5. 加密算法是异或，比较简单
6. 不含帧序号，无法防御重放攻击

## WPA1

针对WEP协议的不足，WPA1是一个增强的过度协议。进行的优化有：

- 使用128位密钥，加密更好
- 支持动态生成密钥
- 用MIC验证码替代CRC-32验证码
- 包含了帧序号（48位序列号），防范重放攻击
- 在开放系统认证、共享密钥认证之外还增加支持了802.1x认证协议（组成TKIP协议）

> 802.1x协议：无线终端向AP发起连接请求时， AP会要求用户输入用户名和密码，再把这个用户名和密码送到验证服务器上去做验证
>
>IEEE802.1x和上层认证协议EAP（Extensible Authentication Protocol）配合来实现用户认证和密钥的动态分发

## WPA2

WPA2是一个进一步增强的协议，包含以下增强：

- 更优的CCMP消息认证码代替了MIC
- 用AES对称加密替代RC4流加密






