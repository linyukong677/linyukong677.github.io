---
layout: post
title: 编译原理04
date: 2022-12-10 17:57 +0800
last_modified_at: 2022-12-10 18:11 +0800
tags: [Notes]
toc:  true
math: true
---

符号表
{: message}

## 符号表的功能和内容

符号表在编译过程中的重要性主要体现在**对于符号表的维护和访问贯穿整个编译过程**。符号表的几个核心功能包括但不限于：
- 与作用域和可见性相关（符号声明的语义检查）
- 与中间代码生成有关（符号的地址分配）

为了满足以上功能的实现，符号表里的每一条表项至少要包含以下属性：

- 符号名
- 符号类别（常量、变量、函数），类型（整数、浮点）
- 符号的存储类别和存储分配信息（静态、动态、寄存器，大小）
- 符号的作用域和可见性

最后我们简单提一下符号表的创建和实现。符号表的创建可以在编译过程的任何时候进行，但是一般在语法分析的过程中创建，至少应该在静态语义分析之前完成。符号表的实现可以采用哈希表、二叉搜索树、红黑树等数据结构，但是一般采用哈希表，因为哈希表的查找效率最高。

## 符号表作用域和可见性

> 本节我们主要研究符号表的作用域和可见性，这是符号表的核心功能之一。

首先介绍几个概念的定义，重点看**开作用域**，**闭作用域**，**当前作用域**，**可见性**的概念：

<a href="https://sm.ms/image/ADCVa5xpjlqkZSM" target="_blank"><img src="https://s2.loli.net/2022/12/10/ADCVa5xpjlqkZSM.png" width=500></a>

符号表的组织形式按照作用域的维护方法可以分为**单符号表组织**和**多符号表组织**两类。

### 单符号表组织

单符号表顾名思义就是在一张表上完成对符号表的维护，要做到这一点就需要能够及时地将新的作用域的符号加入表中并删除已经过时的作用域和符号。具体来说：

- 每个作用域都有一个作用域号
- 当一个作用域成为闭作用域时，将这个作用域中声明的符号从表中删除

> 经过以上规则的维护，单符号表中任何时刻都只有当前开作用域的符号

### 多符号表组织

多符号表顾名思义，每个作用域都有自己的符号表，任何时刻的开作用域符号表是一个或多个各自作用域符号表的拼接和。具体来说：

- 每个作用域都有自己的符号表
- 维护一个作用域符号表栈。
- 当一个新的作用域被创建时，新作用域的符号表入栈
- 当一个作用域成为闭作用域时，从栈顶弹出相应的符号表
- 任意时刻的符号表对应的是栈中所有符号表的拼接和

> 拼接过程中符号表里面会存在同一符号多级定义的现象，此时选择离栈顶最近的定义




